<!DOCTYPE html>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width">
<style>

@import url(http://fonts.googleapis.com/css?family=PT+Serif|PT+Serif:b|PT+Serif:i);

section {
  /* background: #000;
  color: #fff; */
  background: #fff;
  color: #000;
  /* padding: 2em; */
  font-family: "PT Serif", Baskerville, Georgia;
}

#follow {
  background: none;
}

.grey {
  color: #777;
}

a:link,
a:visited {
  color: orange;
  text-decoration: none;
}

a:hover {
  text-decoration: underline;
}

</style>

<section style="text-align:center;padding-top:5em;">
  <p style="font-size:120%;"><b><a href="https://github.com/mbostock/stack">Stack</a></b> is a presentation library<br> with simple, scroll-based navigation.
  <p class="grey">Scroll down to continue.
</section>

<section id='celldega-slide'>

  <!-- <div id='celldega' style="height:600px; margin-bottom: 50px; overflow: hidden"> -->
  <div id='celldega-container' style="height:600px; margin-bottom: 50px; overflow: hidden">
    <!-- here -->
  </div>

</section>


<section style="padding:5em 9em;">
  <p>In addition to the mouse,
    <br>you can scroll with the keyboard:
    <br>use the <b>arrow keys</b>,
    <br>the <b>space bar</b>,
    <br>or <b>page up</b> and <b>page down</b>.
  <p class="grey">Multiple key presses will skip multiple slides.
</section>

<section style="text-align:center;padding-top:5em;">
  <p>You can even grab the scroll bar!
</section>


<section style="text-align:center;padding-top:5em;">
  <p>If you resize the window,
    <br>slide content will scale up or down
    <br>to fit automatically.
</section>


<section style="padding:5em 13em;">
  <p>Stack is made by <a href="http://bost.ocks.org/mike/" rel="author">Mike Bostock</a>
    <br>and is available on <a href="https://github.com/mbostock/stack">GitHub</a>
    <br>under the <a href="https://github.com/mbostock/stack/blob/gh-pages/LICENSE">BSD license</a>.
  <p><a style="color:#777;text-decoration:none;" href="https://github.com/mbostock/stack">View source to get started.</a>
</section>

<script src="d3.v3.min.js"></script>
<script src="stack.v1.min.js"></script>


<script type="module">

import celldega from 'https://unpkg.com/celldega@0.4.3/src/celldega/static/widget.js?module';


var mystack = stack()
    .on("activate", activate)
    .on("deactivate", deactivate);

var section = d3.selectAll("section"),
    follow = d3.select("#follow"),
    followIndex = section[0].indexOf(follow.node());

function refollow() {
  followAnchor.style("top", (followIndex + (1 - mystack.scrollRatio()) / 2 - d3.event.offset) * 100 + "%");
}

function activate(d, i) {
  if (i === followIndex) mystack.on("scroll.follow", refollow);
}

function deactivate(d, i) {
  if (i === followIndex) mystack.on("scroll.follow", null);
}


// celldega code
const ini_x = 20000
const ini_y = 15000
const ini_z = 0
const ini_zoom = -5.5
const token = ''

const dataset_name = 'Xenium_Prime_Mouse_Brain_Coronal_FF_outs'
const repo_name = 'celldega_' + dataset_name
const base_url = 'https://raw.githubusercontent.com/broadinstitute/' + repo_name + '/main/' + dataset_name

console.log('base_url', base_url);

// const celldega_container = d3.select("#celldega")
const celldega_container = d3.select("#celldega-container").node();

console.log('celldega_container', celldega_container);

celldega.landscape_ist(
    celldega_container,
    {},
    token,
    ini_x,
    ini_y,
    ini_z,
    ini_zoom,
    base_url,
    '',
    0.25,
    '100%',
    '100%'
  )


</script>
